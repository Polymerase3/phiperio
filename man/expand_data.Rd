% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data-validate.R
\name{expand_data}
\alias{expand_data}
\title{Expand to a full \code{sample_id * peptide_id} grid}
\usage{
expand_data(
  x,
  key_col = "sample_id",
  id_col = "peptide_id",
  fill_override = NULL,
  add_exist = FALSE,
  exist_col = "exist",
  validate = TRUE,
  ...
)
}
\arguments{
\item{x}{A \verb{<phip_data>} object.}

\item{key_col}{Name(s) of the sample identifier column(s). Character scalar
or vector, e.g. \code{"sample_id"} or \code{c("subject_id", "timepoint_factor")}.}

\item{id_col}{Name of the peptide identifier column. Default \code{"peptide_id"}.}

\item{fill_override}{Optional named list of fill values for \strong{introduced}
rows, e.g. \code{list(present = 0L, fold_change = NA_real_)}. User-provided
entries take precedence over the defaults.}

\item{add_exist}{If \code{TRUE}, add an integer existence flag (0/1) marking
whether a row was present before the expansion.}

\item{exist_col}{Name for the existence flag. If this column already exists,
it will be \strong{overwritten}.}

\item{validate}{Logical; if \code{TRUE}, perform input checks for required
columns and uniqueness. Set to \code{FALSE} when these checks were already
performed upstream (e.g., inside \code{validate_phip_data()}).}

\item{...}{Reserved for future extensions; currently unused.}
}
\value{
The updated \verb{<phip_data>} object.
}
\description{
Create the full Cartesian product of samples and peptides and
join back per-sample metadata. For rows introduced by the expansion,
numeric/integer columns are filled with \code{0} and logical columns with
\code{FALSE}, unless overridden via \code{fill_override}.
}
\details{
Updates \code{x$data_long} in place (preserving laziness unless you later
\code{compute()} / \code{collect()}).
}
\examples{
\donttest{
pd <- expand_data(pd, fill_override = list(fold_change = NA_real_))
}
}
